<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MileTracker Pro API Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .api-endpoint { 
            background: #f8f9fa; 
            border-left: 4px solid #007bff; 
            padding: 15px; 
            margin: 15px 0; 
        }
        .method-get { border-left-color: #28a745; }
        .method-post { border-left-color: #ffc107; }
        .method-put { border-left-color: #fd7e14; }
        .method-delete { border-left-color: #dc3545; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 5px; }
        .tier-badge { font-size: 0.8em; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <h1 class="mb-4">MileTracker Pro API Documentation</h1>
                
                <div class="alert alert-info">
                    <h5>Secure Professional API</h5>
                    <p>Access mileage tracking data with enterprise-grade security, encryption, and rate limiting.</p>
                </div>

                <div class="row">
                    <div class="col-md-8">
                        
                        <!-- Authentication Section -->
                        <h2>Authentication</h2>
                        
                        <div class="api-endpoint method-post">
                            <h4>User Login & Registration</h4>
                            <code>POST /api/auth/login</code>
                            <p>Create account or login to get JWT token for API access.</p>
                            <pre>{
  "email": "user@example.com",
  "password": "your-secure-password"
}</pre>
                            <p><strong>Returns:</strong> JWT token for authenticated requests</p>
                        </div>

                        <!-- API Key Management -->
                        <h2>API Key Management</h2>
                        
                        <div class="api-endpoint method-post">
                            <h4>Create API Key</h4>
                            <code>POST /api/keys</code>
                            <p>Generate API keys for external applications (QuickBooks, custom apps)</p>
                            <pre>{
  "name": "QuickBooks Integration",
  "tier": "business"
}</pre>
                            <p><strong>Requires:</strong> Authorization: Bearer YOUR_JWT_TOKEN</p>
                        </div>

                        <div class="api-endpoint method-get">
                            <h4>List API Keys</h4>
                            <code>GET /api/keys</code>
                            <p>View all your API keys with usage statistics</p>
                            <p><strong>Requires:</strong> Authorization: Bearer YOUR_JWT_TOKEN</p>
                        </div>

                        <!-- Trip Data Access -->
                        <h2>Trip Data Access</h2>
                        
                        <div class="api-endpoint method-get">
                            <h4>Get User Trips (Mobile App)</h4>
                            <code>GET /api/trips</code>
                            <p>Retrieve all trips for authenticated user (mobile app access)</p>
                            <p><strong>Requires:</strong> Authorization: Bearer YOUR_JWT_TOKEN</p>
                        </div>

                        <div class="api-endpoint method-get">
                            <h4>External API Access</h4>
                            <code>GET http://localhost:5000/api/external/trips</code>
                            <p>Access trip data from external applications with API key</p>
                            <p><strong>Requires:</strong> X-API-Key: YOUR_API_KEY</p>
                            <p><strong>Returns:</strong> Decrypted trip data + API usage info</p>
                            <p><strong>Note:</strong> API server runs on port 5000, documentation on port 8080</p>
                        </div>

                        <!-- Privacy & Security -->
                        <h2>Privacy & Security Features</h2>
                        <ul>
                            <li><strong>Data Encryption:</strong> GPS coordinates, addresses, client names, and notes encrypted at rest</li>
                            <li><strong>Password Hashing:</strong> bcrypt with 12 salt rounds</li>
                            <li><strong>JWT Authentication:</strong> Secure token-based authentication</li>
                            <li><strong>Rate Limiting:</strong> API key-based usage tracking and limits</li>
                            <li><strong>User Isolation:</strong> Complete data separation between users</li>
                            <li><strong>HTTPS Enforcement:</strong> All data transmission encrypted</li>
                        </ul>

                        <!-- Example Integration -->
                        <h2>Integration Examples</h2>
                        
                        <h4>QuickBooks Integration</h4>
                        <pre>// JavaScript example
const response = await fetch('https://api.yourdomain.com/api/external/trips', {
  headers: {
    'X-API-Key': 'mt_your_api_key_here',
    'Content-Type': 'application/json'
  }
});

const data = await response.json();
console.log('Mileage trips:', data.trips);
console.log('API usage:', data.api_key_info);</pre>

                        <h4>Custom Replit App Integration</h4>
                        <pre>// Node.js example
const apiKey = 'mt_your_api_key_here';
const trips = await fetch(`https://api.yourdomain.com/api/external/trips`, {
  headers: { 'X-API-Key': apiKey }
}).then(res => res.json());

// Process trip data for your app
trips.trips.forEach(trip => {
  console.log(`${trip.start_address} â†’ ${trip.end_address}: ${trip.distance_miles} miles`);
});</pre>

                    </div>
                    
                    <div class="col-md-4">
                        <!-- Pricing Tiers -->
                        <div class="card">
                            <div class="card-header">
                                <h5>API Pricing Tiers</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <span class="badge bg-info tier-badge">DEVELOPER</span>
                                    <h6>$10/month</h6>
                                    <ul class="small">
                                        <li>1,000 API calls/month</li>
                                        <li>Basic rate limiting</li>
                                        <li>Email support</li>
                                    </ul>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="badge bg-primary tier-badge">BUSINESS</span>
                                    <h6>$25/month</h6>
                                    <ul class="small">
                                        <li>10,000 API calls/month</li>
                                        <li>Priority support</li>
                                        <li>Custom integrations</li>
                                    </ul>
                                </div>
                                
                                <div class="mb-3">
                                    <span class="badge bg-success tier-badge">ENTERPRISE</span>
                                    <h6>$100/month</h6>
                                    <ul class="small">
                                        <li>Unlimited API calls</li>
                                        <li>White label options</li>
                                        <li>Dedicated support</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Test -->
                        <div class="card mt-3">
                            <div class="card-header">
                                <h5>Quick API Test</h5>
                            </div>
                            <div class="card-body">
                                <button class="btn btn-outline-primary btn-sm" onclick="testHealthCheck()">
                                    Test Health Check
                                </button>
                                <div id="testResult" class="mt-2"></div>
                            </div>
                        </div>

                        <!-- Status -->
                        <div class="card mt-3">
                            <div class="card-header">
                                <h5>API Status</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <span>Status:</span>
                                    <span class="badge bg-success">Online</span>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span>Version:</span>
                                    <span>1.0.0</span>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span>Encryption:</span>
                                    <span class="badge bg-info">AES-256</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function testHealthCheck() {
            const resultDiv = document.getElementById('testResult');
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                resultDiv.innerHTML = `<div class="alert alert-success small">API Online: ${data.status}</div>`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="alert alert-danger small">Error: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>